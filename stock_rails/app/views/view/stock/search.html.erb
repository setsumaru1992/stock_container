<details>
  <summary>検索条件はこちら</summary>
  <form acrion="./" method="get">
    並び順<input type="text" name="order" value="<%= @order %>"><br>
    <label><input type="checkbox" name="only_nikkei225" value="on" <% if @only_nikkei225 == "on" %>checked<% end %>>日経225のみ</label><br>
    「(カラム名) + (ソートタイプ)」を入力。ソートタイプは1:昇順,2: 降順。「,」区切りで複数入力可能(デフォルト:code1)<br>
    <button type="submit">検索</button><br>
  </form>
  パラメータ例
  <%= @parameter_example %>
  <%= @only_nikkei225 %>
</details>

<% if @stocks.empty? %>
  検索条件に合致するものが見つかりませんでした。
<% else %>
  <%= @stocks.size %>件ヒット
  <div style="overflow: scroll; height: 1000px; width: 100%">
  <table class="table table-striped">
    <thead>
      <tr>
        <th>銘柄<br><%= link_to "昇順", view_stock_search_path(order: "code1") %>&nbsp;/&nbsp;<%= link_to "降順", view_stock_search_path(order: "code2") %></th>
        <th>時価総額(億)<br><%= link_to "昇順", view_stock_search_path(order: "market_capitalization1") %>&nbsp;/&nbsp;<%= link_to "降順", view_stock_search_path(order: "market_capitalization2") %></th>
        <th>株価(<%=@current_price_day %>)<br><%= link_to "昇順", view_stock_search_path(order: "price1") %>&nbsp;/&nbsp;<%= link_to "降順", view_stock_search_path(order: "price2") %></th>
        <th>業種<br><%= link_to "昇順", view_stock_search_path(order: "category1") %>&nbsp;/&nbsp;<%= link_to "降順", view_stock_search_path(order: "category2") %></th>
        <th>特色</th>
        <th>上場年<br><%= link_to "昇順", view_stock_search_path(order: "listed_year1") %>&nbsp;/&nbsp;<%= link_to "降順", view_stock_search_path(order: "listed_year2") %></th>
        <th>日経225入り</th>
        <th>売上高(百万)<br><%= link_to "昇順", view_stock_search_path(order: "net_sales_profit_rate1") %>&nbsp;/&nbsp;<%= link_to "降順", view_stock_search_path(order: "net_sales_profit_rate2") %></th>
        <th>営業利益(百万)<br><%= link_to "昇順", view_stock_search_path(order: "operating_income_profit_rate1") %>&nbsp;/&nbsp;<%= link_to "降順", view_stock_search_path(order: "operating_income_profit_rate2") %></th>
        <th>経常利益(百万)<br><%= link_to "昇順", view_stock_search_path(order: "ordinary_income_profit_rate1") %>&nbsp;/&nbsp;<%= link_to "降順", view_stock_search_path(order: "ordinary_income_profit_rate2") %></th>
        <th>純利益(百万)<br><%= link_to "昇順", view_stock_search_path(order: "net_income_profit_rate1") %>&nbsp;/&nbsp;<%= link_to "降順", view_stock_search_path(order: "net_income_profit_rate2") %></th>
      </tr>
    </thead>
    <tbody>
      <% @stocks.each do |stock| %>
        <tr>
          <td><%= %><%= stock["code"] %>&nbsp;
            <a href="https://moyamoya.space/dailyutil/stockInfo/access2sbi_chart?stock_code=<%= stock["code"] %>" target="blank">
             <%= stock["name"] %></td>
            </a>
          <td><%= stock["market_capitalization"] %></td>
          <td><%= stock["price"] %></td>
          <td>
            <%= stock["category"] %>
            <% if stock["category_rank"] %>
            (<%= stock["category_rank"] %>位)
            <% end %>
          </td>
          <td>
            <details>
              <summary><%= stock["feature"].slice(0..7) %></summary>
              <%= stock["feature"] %>
            </details>
          </td>
          <td><%= stock["listed_year"] %></td>
          <td><%= stock["is_nikkei_average_group"] %></td>
          <td>
            <% if stock["latest_net_sales"].present? && stock["ref_net_sales"].present? && stock["net_sales_profit_rate"].present? %>
              <%= @latest_first_year %>年<br><%= stock["latest_net_sales"] %><br><%= @latest_first_year - 1 %>年<br><%= stock["ref_net_sales"] %><br><%= stock["net_sales_profit_rate"].round(2) %>%
            <% end %>
          </td>
          <td>
            <% if stock["latest_operating_income"].present? && stock["ref_operating_income"].present? && stock["operating_income_profit_rate"].present? %>
              <%= @latest_first_year %>年<br><%= stock["latest_operating_income"] %><br><%= @latest_first_year - 1 %>年<br><%= stock["ref_operating_income"] %><br><%= stock["operating_income_profit_rate"].round(2) %>%
            <% end %>
          </td>
          <td>
            <% if stock["latest_ordinary_income"].present? && stock["ref_ordinary_income"].present? && stock["ordinary_income_profit_rate"].present? %>
              <%= @latest_first_year %>年<br><%= stock["latest_ordinary_income"] %><br><%= @latest_first_year - 1 %>年<br><%= stock["ref_ordinary_income"] %><br><%= stock["ordinary_income_profit_rate"].round(2) %>%
            <% end %>
          </td>
          <td>
            <% if stock["latest_net_income"].present? && stock["ref_net_income"].present? && stock["net_income_profit_rate"].present? %>
              <%= @latest_first_year %>年<br><%= stock["latest_net_income"] %><br><%= @latest_first_year - 1 %>年<br><%= stock["ref_net_income"] %><br><%= stock["net_income_profit_rate"].round(2) %>%
            <% end %>
          </td>
        </tr>
      <% end %>
    </tbody>
  </table>
  </div>
<% end %>
